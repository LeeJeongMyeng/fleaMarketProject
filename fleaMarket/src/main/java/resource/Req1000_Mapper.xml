<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
   

    <mapper namespace="fleaMarket.a03_dao.Req1000_Dao">
    	<!-- 이메일 중복검사 -->
    	<select id="DuplicateEmail" parameterType="string" resultType="member">
    		SELECT * FROM FLEAMARKETMEMBER WHERE email = #{email}
    	</select>
    	<!-- 이름/주민 중복검사 -->
    	<select id="DuplicateMem" parameterType="hashmap" resultType="member">
    	SELECT * FROM FLEAMARKETMEMBER WHERE name = #{name} and personalnumber = #{personalnumber}
    	</select>
    	
    	<!--회원가입 -->
    	<insert id="SignUp" parameterType="member">
    		INSERT INTO FLEAMARKETMEMBER values(
				#{email},
				#{password},
				#{nickname},
				#{personalnumber},
				#{phonenumber},
				#{address},
				#{authority},
				NULL,
				NULL,
				NULL,
				#{category},
				#{name}
				)
    	</insert>
    	
    	<!--회원가입시 해당 회원 프로필사진 삽입  -->
    	<insert id="insprofile" parameterType="profileimg">
    		INSERT INTO PROFILE VALUES(#{email},#{profileimg})
    	</insert>
    	
    	<select id="Login" parameterType="member" resultType="member">
    		SELECT * FROM FLEAMARKETMEMBER
    		WHERE EMAIL = #{email}
    		AND PASSWORD = #{password}
    	</select>
    	<select id="kakaoLogin" parameterType="member" resultType="member">
    		SELECT * FROM FLEAMARKETMEMBER
    		WHERE KAKAOEMAIL=#{kakaoemail}
    	</select>
    	<select id="naverLogin" parameterType="member" resultType="member">
    		SELECT * FROM FLEAMARKETMEMBER
    		WHERE NAVEREMAIL=#{naveremail}
    	</select>
    	
    	<select id="CheckPeristalsisSNS_K" parameterType="string" resultType="member">
    		SELECT * FROM FLEAMARKETMEMBER 		
    			WHERE EMAIL = #{snsemail}
    	</select>
    	<select id="CheckPeristalsisSNS_N" parameterType="string" resultType="member">
    		SELECT * FROM FLEAMARKETMEMBER 		
    			WHERE NAME = #{name}
    	</select>
    	
    	<update id="SnsEmailPlus" parameterType="member">
    		UPDATE FLEAMARKETMEMBER 
    		<choose>
    			<when test="name==null">
    				SET KAKAOEMAIL = #{kakaoemail}
					WHERE EMAIL =#{kakaoemail}
    			</when>
    			<otherwise>
    				SET NAVEREMAIL=#{naveremail}
					where name=#{name}
    			</otherwise>
    		</choose>
    	</update>
    	
    </mapper>
    
    